---
- name: Include install steps
  import_tasks: install.yml

- name: Include dualstack configuration
  import_tasks: configure_dualstack.yml

- name: Include clustering steps
  import_tasks: form_cluster.yml
  when: new_cluster

- name: chown ~/.kube
  ansible.builtin.file:
    path: /home/ubuntu/.kube
    state: directory
    owner: ubuntu
    recurse: true
  become: yes

- name: Create kubectl alias
  ansible.builtin.lineinfile:
    path: /home/ubuntu/.bash_aliases
    line: alias kubectl="microk8s.kubectl"
